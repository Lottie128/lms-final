[phases.setup]
nixPkgs = ['...', 'curl']

[phases.install]
cmds = [
  'curl -fsSL https://bun.sh/install | bash',
  'export BUN_INSTALL="$HOME/.bun"',
  'export PATH="$BUN_INSTALL/bin:$PATH"',
  'bun install'
]

[phases.build]
cmds = [
  'export BUN_INSTALL="$HOME/.bun"',
  'export PATH="$BUN_INSTALL/bin:$PATH"',
  'cd packages/backend && bun install',
  'cd packages/backend && bunx prisma generate',
  'cd packages/backend && bun run build'
]

[start]
cmd = 'export BUN_INSTALL="$HOME/.bun" && export PATH="$BUN_INSTALL/bin:$PATH" && cd packages/backend && bun run start'
